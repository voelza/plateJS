(function(a,v){typeof exports=="object"&&typeof module<"u"?v(exports):typeof define=="function"&&define.amd?define(["exports"],v):(a=typeof globalThis<"u"?globalThis:a||self,v(a.PlateJS={}))})(this,function(a){"use strict";function v(e){const t={};return{dom:E(y(e,t),e),refs:t}}function E(e,t){const n={};return Object.entries(e).forEach(([o,r])=>n[o]=r),n.__self=t,n}function y(e,t){const n={};for(let o=0;o<e.children.length;o++){const r=e.children[o],i=[r.tagName.toLowerCase()],c=r.getAttribute("ref");c&&i.push(c);for(const s of i){let f=n[s]instanceof Array;!f&&n[s]&&(f=!0,n[s]=[n[s]]);let l;r.children.length===0?l=r:l=E(y(r,t),r),f?n[s].push(l):n[s]=l,c&&(t[c]=n[s])}}return n}let p=!1,m=[];function A(e){const t={value:e,observers:[]};return[()=>(p&&m.push(t),t.value),n=>{t.value=n;for(const o of t.observers)o.update()}]}function O(e){const t={value:void 0,observers:[]};return d(()=>{t.value=e();for(const n of t.observers)n.update()}),()=>(p&&m.push(t),t.value)}function d(e){w(e,e)}function w(e,t){if(p=!0,e(),m.length>0){const n={update:t};for(const o of m)o.observers.push(n)}p=!1,m=[]}function j(e,t){d(()=>{const n=t();u(e,o=>o.textContent=n)})}function T(e,t,n){d(()=>{const o=n();let r;typeof o=="object"?r=Object.entries(o).map(([i,c])=>`${i}:${c}`).join(";"):r=o,u(e,i=>M(i).setAttribute(t,r))})}function _(e,t){const n=new Map;u(e,r=>{var c;const i=new Text;(c=r.parentElement)==null||c.insertBefore(i,r),n.set(r,i)});let o;d(()=>{const r=t();try{if(r===o)return;u(e,i=>{var c;if(r){const s=n.get(i);(c=s==null?void 0:s.parentElement)==null||c.insertBefore(i,s.nextSibling)}else i.remove()})}catch(i){console.error(i)}finally{o=r}})}function B(e,t,n){const o=new Map,r=new Map;u(e,c=>{var f;const s=new Text;(f=c.parentElement)==null||f.insertBefore(s,c),o.set(c,s),r.set(c,[]),c.remove()});let i;d(()=>{const c=t();try{if(c===i)return;u(e,s=>{var k;const f=r.get(s);for(const h of f)h.remove();const l=o.get(s);for(let h=0;h<c.length;h++){const C=c[h],g=s.cloneNode(!0);(k=l==null?void 0:l.parentElement)==null||k.insertBefore(g,l),f==null||f.push(g),requestAnimationFrame(()=>n({element:g,item:C,index:h}))}})}catch(s){console.error(s)}finally{i=c}})}function D(e){d(e)}function R(e,...t){w(()=>t.forEach(n=>n()),e)}function b(e,t,n){u(e,o=>o.addEventListener(t,n))}function S(e,t){b(e,"click",t)}function F(e,t,n){u(e,o=>{b(o,"input",r=>{const c=r.target,s=c.value;let f=s;switch(c.type){case"number":case"range":f=parseFloat(s);case"date":case"datetime-local":f=new Date(s);case"checkbox":case"radio":f=c.checked}n(f)})}),d(()=>{const o=t();u(e,r=>{const i=r;i.type==="checkbox"||i.type==="radio"?i.checked=o:i.value=o})})}function M(e){return e instanceof Element?e:e.__self}function u(e,t){let n;e instanceof Array?n=[...e]:n=[e],n.forEach(o=>t(M(o)))}a.attr=T,a.click=S,a.computed=O,a.create=v,a.event=b,a.forEach=B,a.model=F,a.renderIf=_,a.state=A,a.text=j,a.watch=D,a.watchDetached=R,Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
