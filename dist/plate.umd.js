(function(a,h){typeof exports=="object"&&typeof module<"u"?h(exports):typeof define=="function"&&define.amd?define(["exports"],h):(a=typeof globalThis<"u"?globalThis:a||self,h(a.PlateJS={}))})(this,function(a){"use strict";function h(e){const n={};return{dom:E(y(e,n),e),refs:n}}function E(e,n){const s={};return Object.entries(e).forEach(([o,t])=>s[o]=t),s.__self=n,s}function y(e,n){const s={};for(let o=0;o<e.children.length;o++){const t=e.children[o],c=[t.tagName.toLowerCase()],r=t.getAttribute("ref");r&&c.push(r);for(const i of c){let u=s[i]instanceof Array;!u&&s[i]&&(u=!0,s[i]=[s[i]]);let l;t.children.length===0?l=t:l=E(y(t,n),t),u?s[i].push(l):s[i]=l,r&&(n[r]=s[i])}}return s}let p;function w(e){return(n=void 0)=>n?e:(p&&e.observers.add(p),e.value)}function M(e){const n={value:e,observers:new Set};return[w(n),s=>{n.value=s,n.observers.forEach(o=>o.update())}]}function k(e){const n={value:void 0,observers:new Set};return d(()=>{n.value=e();for(const s of n.observers)s.update()}),w(n)}function d(e){const n={update:()=>{p=n,e(),p=void 0}};return n.update(),n}function A(e,n){d(()=>{const s=n();f(e,o=>o.textContent=s)})}function S(e,n,s){d(()=>{const o=s();let t;typeof o=="object"?t=Object.entries(o).map(([c,r])=>`${c}:${r}`).join(";"):t=o,typeof t=="boolean"?Boolean(t)?f(e,c=>b(c).setAttribute(n,"")):f(e,c=>b(c).removeAttribute(n)):f(e,c=>b(c).setAttribute(n,t))})}function x(e,n){const s=new Map;f(e,t=>{var r;const c=new Text;(r=t.parentElement)==null||r.insertBefore(c,t),s.set(t,c)});let o;d(()=>{const t=n();try{if(t===o)return;f(e,c=>{var r;if(t){const i=s.get(c);(r=i==null?void 0:i.parentElement)==null||r.insertBefore(c,i.nextSibling)}else c.remove()})}catch(c){console.error(c)}finally{o=t}})}function I(e,n,s){const o=new Map,t=new Map;f(e,r=>{var u;const i=new Text;(u=r.parentElement)==null||u.insertBefore(i,r),o.set(r,i),t.set(r,[]),r.remove()});let c;d(()=>{const r=n();try{if(r===c)return;f(e,i=>{var T;const u=t.get(i);for(const v of u)v.remove();const l=o.get(i);for(let v=0;v<r.length;v++){const H=r[v],g=i.cloneNode(!0);(T=l==null?void 0:l.parentElement)==null||T.insertBefore(g,l),u==null||u.push(g),requestAnimationFrame(()=>s({element:g,item:H,index:v}))}})}catch(i){console.error(i)}finally{c=r}})}function L(e){d(e)}function O(e,...n){const s=d(e);for(const o of n)o(!0).observers.add(s)}function m(e,n,s){f(e,o=>o.addEventListener(n,s))}function j(e,n){m(e,"click",n)}function D(e,n,s){f(e,o=>{m(o,"input",t=>{const c=t;let r;if(c.target instanceof HTMLInputElement){const i=c.target.value;switch(r=i,c.target.type){case"number":case"range":r=parseFloat(i);break;case"date":case"datetime-local":r=new Date(i);break;case"checkbox":case"radio":r=c.target.checked;break}}else o instanceof HTMLTextAreaElement?r=o.value:c.target instanceof HTMLSelectElement&&(r=c.target.options[c.target.selectedIndex].text);s(r)})}),d(()=>{const o=n();f(e,t=>{if(t instanceof HTMLInputElement)t.type==="checkbox"||t.type==="radio"?t.checked=o:t.type==="date"&&o instanceof Date?t.value=o.toISOString().split("T")[0]:t.value=o;else if(t instanceof HTMLTextAreaElement)t.value=o;else if(t instanceof HTMLSelectElement){let c=0;for(let r=0;r<t.options.length;r++)if(t.options[r].text===o){c=r;break}t.selectedIndex=c}})})}function b(e){return e instanceof Element?e:e.__self}function f(e,n){let s;e instanceof Array?s=[...e]:s=[e],s.forEach(o=>n(b(o)))}a.attr=S,a.click=j,a.computed=k,a.create=h,a.event=m,a.forEach=I,a.model=D,a.renderIf=x,a.state=M,a.text=A,a.watch=L,a.watchDetached=O,Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
